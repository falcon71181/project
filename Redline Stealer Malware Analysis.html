<!DOCTYPE html>

<html lang="en-US">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./Anubis Android Malware Analysis _files/style.css">
<title>Anubis Android Malware Analysis | Malware Hunters</title>
<style type="text/css" nonce="undefined"></style></head>

  <body data-new-gr-c-s-check-loaded="14.1042.0" data-gr-ext-installed="">
    <div class="backgroundvideo">
      <video id="background-video" autoplay loop muted>
        <source src="index_files/background.mp4"
      </video>
    </div>

    <header>
      <div class="container">
        <a id="a-title" href="index.html">
          <h1 style="color: #fa4103;"><strong>./Malware Hunters {OG_34}</strong></h1>
          <h4 style="color: #fa4103;"><strong>We Hunt The Hunters</strong></h4>
        </a>
        <h2 id="status">Trojan / RAT / Malware / Botnet / Stealer / Ransomeware</h2>

        <section id="downloads">
          <span>
          <a href="https://github.com/falcon71181" class="btn" target="_blank"><img src="index_files/github.png" width="30px" style="font-size:20px"></a></span>
          <span><a href="https://twitter.com/AbbuDerty" class="btn" target="_blank"><img src="index_files/twitter.png" width="30px" style="font-size:20px"></a></span>
          <span><a href="https://www.facebook.com/abbu.thakur.148" class="btn" target="_blank"><img src="index_files/facebook.png" width="30px" style="font-size:20px"></a></span>
          <span><a href="https://www.youtube.com/channel/UC1uyCUskC_N0oan-TIXOqPg" class="btn" target="_blank"><img src="index_files/youtube.png" width="30px" style="font-size:20px"></a></span>
          <span><a href="mailto:abhay2072.be21@chitkara.edu.in" class="btn" target="_blank"><img src="index_files/mail.png" width="30px" style="font-size:20px"></a></span>
          <span><a href="https://wa.me/917650902712" class="btn" target="_blank"><img src="index_files/whatsapp.png" width="30px" style="font-size:20px"></a></span>
          <span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
          <span class="btn">
			
						<a href="tools.html" width="30px" style="font-size:20px">Tools</a></span>
            &nbsp;
            <span class="btn"><a href="about.html" width="30px" style="font-size:20px">About</a></span>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <span class="btn"><a href="sign_in_up.html" width="30px" style="font-size:20px">Sign in</a></span>
            &nbsp;
						<span class="btn"><a href="sign_in_up.html" width="30px" style="font-size:20px">Sign up</a></span>
    </header>
    <br>
    <div class="container">
      <section id="main_content">
        <a href="index.html">&lt;- Home</a><br><br>
<small>17 Dec. 2021</small>
<strong><h1 style="color: #fa4103;">Anubis Android Malware Analysis</h1></strong>

<h2 id="pdf-version"><a href="https://www.youtube.com/watch?v=BqFIoviIuiE" target="_blank">Youtube Demo</a></h2>
<h2 id="introduction">Introduction</h2>

<p>RedLine is a newly emerging infostealer. An infostealer malware is designed to gather information, and steal valuable assets from an infected system. The most common form of infostealer is to gather login information, like usernames and passwords. RedLine was first being noticed at 2020 via COVID-19 phishing emails, and has been active in 2021. RedLine is almost everywhere, and has appeared variously as trojanized services, games, and cracks. RedLine is used for extensive information stealing operations, like: credit card credentials, Crypto wallets, sensitive files, etc. Furthermore, RedLine also can be used as malware loader or dropper for extended malicious impact. For instance, it can be used to infect the victim with additional malwares like ransomwares.</p>

<p>The RedLine malware family has been distributed and sold mostly via underground malware forums. Many samples of RedLine also appear with legit-looking digital certificates. RedLine is considered as one of the most serious threats that are currently in the wild, therefore it is a must to know how it works, how to detect it, and how to protect your organization.</p>

<h2 id="two-stages-of-anubis">Technical Summary</h2>

<p><strong class="language-plaintext highlighter-rouge">Configuration Extraction:</strong> RedLine comes with embedded configuration, in this variant, the configuration is Base64 encoded plus an additional layer of XOR encryption with hard-coded key. These configuration contains the C&C server and the malware Botnet ID , which it will communicate with to exfiltrate gathered information, and also for further remote commands.
    <br><br><strong class="language-plaintext highlighter-rouge">C2 Communication:</strong> After extracting the C&C and before doing anything, RedLine will check if there is a possibility to reach its C&C server. If there is an available connection, RedLine will then try to obtain the malicious Scan Settings. These scan arguments contain flags that will be used to determine which information to be stolen. Moreover, the obtained scan arguments contain tuning parameters, to specify desired data assets. For instance, search patterns to specify certain files to be exfiltrated, etc.
    <br><br><strong class="language-plaintext highlighter-rouge">Host Profiling:</strong> RedLine will gather information about the infected host, in order to decide further actions. Mostly relying on Windows Management Instrumentation (WMI), it harvests and generates the following information: Hardware ID, Usernames, OS version, Installed languages, Installed programs, Current running processes, Anti-malware products, Graphics card info, Victim’s Location, IP address, etc. In addition to all these, RedLine contains functions to exclude Blacklisted countries as well as Blocked IPs from infection.
    <br><br><strong class="language-plaintext highlighter-rouge">Information Stealing:</strong> Here lies the bulk of its functionality. As being an information stealer, based on the obtained scan arguments, RedLine can exfiltrates the following information:
    <br>
    <ul>
    <li>Files: Any specified files in the following directories: ProgramData, Program Files, Program Files (x86).</li>
    <li>Browsers: Login credentials, Cookies, Auto-fill fields used by websites, and Credit card details.</li>
    <li>Crypto Wallets: Credentials of: Armory, Exodus, Ethereum, Monero, Atomic, BinanceChain, and a lot more.</li>
    <li>VPN Clients: Credentials of the following VPN clients: NordVPN, ProtonVPN, and OpenVPN.</li>
    <li>Gaming Clients: It’s targeting the credentials of the famous Valve’s Steam gaming platform.</li>
    <li>Instant Messengers: Currently it’s targeting Telegram session data and Discord tokens.</li>
    <li>Instant Messengers: Currently it’s targeting Telegram session data and Discord tokens.</li>
    </ul><br>
    <strong>Remote Execution:</strong> After successful data exfiltration, RedLine will try to obtain additional remote commands to execute within the infected machine. Going beyond information stealing, RedLine is able to perform the following remote actions:
    Download additional files.
    Download and execute PE files (i.e. additional malware like ransomware).
    Open desired links (i.e. malicious websites).
    Execute remote commands via CMD.exe .</p>

<h2 id="droppers">First Look</h2>

<img src="Redline Stealer Malware Analysis_files/virus_total.png" alt="anubis" width="77%">

<h2 id="iocs">IoCs</h2>

<table>
  <thead>
    <tr>
      <th>No.</th>
      <th>Description</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>Initial packed file</td>
      <td>1d91ab82e01d7682deecbeef7b441f26e405c0053e0354e92fdb5cfe61b097b0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Unpacked RedLine</td>
      <td>e9905446c858326e8f0fe12f6df777542180608381f1ccae4bda9a8356b04abc</td>
    </tr>
    <tr>
      <td>3</td>
      <td>RedLine C&amp;C server</td>
      <td>188.124.36.242:25802</td>
    </tr>
  </tbody>
</table>

<h2 id="configuration-extraction">Configuration Extraction</h2>

<p><a href="Redline Stealer Malware Analysis_files/entrypoint.png"><img src="Redline Stealer Malware Analysis_files/entrypoint.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(2): <u>RedLine code entry point.</u> </font></center>
<p><br />
RedLine begins with hiding its UI from the infected user. It dynamically resolves <code class="language-plaintext highlighter-rouge">GetConsoleWindow()</code> and <code class="language-plaintext highlighter-rouge">ShowWindow()</code> APIs do that. RedLine calls <code class="language-plaintext highlighter-rouge">ShowWindow()</code> with the parameter <code class="language-plaintext highlighter-rouge">SW_HIDE=0</code> to effectively hide its window.</p>

<p><a href="Redline Stealer Malware Analysis_files/decrypt.png"><img src="Redline Stealer Malware Analysis_files/decrypt.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(3): <u>The function used for decrypting the embedded configuration.</u> </font></center>
<p><br />
Then, it uses the <code class="language-plaintext highlighter-rouge">Decrypt()</code> function to extract the embedded encrypted configuration. For this particular sample, the decrypted <u>C&amp;C</u> is <code class="language-plaintext highlighter-rouge">"188.124.36.242:25802"</code> and the decrypted <u>Botnet</u> ID is <code class="language-plaintext highlighter-rouge">"paladin"</code>. The Botent ID is being used to track the malware and to better identify the infected machines.</p>

<h2 id="c2-communication">C2 Communication</h2>

<p>After successfully extracting the C&amp;C IP address, RedLine will check if it can reach the C&amp;C server using the functions <code class="language-plaintext highlighter-rouge">RequestConnection()</code> and <code class="language-plaintext highlighter-rouge">TryGetConnection()</code>. If there is an available connection, RedLine will then try to obtain the malicious <u>Scan Settings</u> using the function <code class="language-plaintext highlighter-rouge">TryGetArgs()</code>. These settings simply represents the full arsenal of RedLine, and what capabilities it possess. The available scan settings are below:</p>

<p><a href="Redline Stealer Malware Analysis_files/scan_args_class.png"><img src="Redline Stealer Malware Analysis_files/scan_args_class.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(4): <u>For simplicity sake , this screenshot is taken using Sublime and not dnSpy in order to show only the useful code.</u> </font></center>
<p><br />
These scan arguments contain flags that will be used to determine which information to be stolen. Each flag is used in certain functions to decide whether to perform the scanning functionality or not -I will show examples in a moment. Moreover, the obtained scan arguments contain tuning parameters, to specify desired data assets. For instance, they contain search patterns to specify files to be exfiltrated, paths for locating certain browsers, or a list of Blacklisted countries to exclude from infection, etc. After getting the scanning arguments (settings), RedLine proceeds to preform its main purpose, which is information stealing.</p>

<h2 id="information-stealing">Information Stealing</h2>

<p><a href="Redline Stealer Malware Analysis_files/part_sender_class.png"><img src="Redline Stealer Malware Analysis_files/part_sender_class.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(5): <u>The functions names &amp; lots of code were obfuscated to make reverse engineering harder.</u> </font></center>
<p><br />
RedLine contains many functions to collect and harvest almost every valuable asset in the infected machine. Some of these functions are very simple, regarding the purpose and the implementation. For instance, <code class="language-plaintext highlighter-rouge">Enumerate_username()</code>, <code class="language-plaintext highlighter-rouge">Get_Malware_Path()</code>, <code class="language-plaintext highlighter-rouge">Enumerate_OS_Version()</code>,etc.</p>

<p>Yet, before proceeding to the scanning functionality once again, RedLine instantiates very important data structures, which will be populated with the stolen assets and the gathered host profile. Below are the two important classes <code class="language-plaintext highlighter-rouge">ScanResult</code> and <code class="language-plaintext highlighter-rouge">ScanDetails</code> :</p>

<p><a href="Redline Stealer Malware Analysis_files/scan_results1.png"><img src="Redline Stealer Malware Analysis_files/scan_results1.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(6): <u>The rest of the customized classes will be discussed in the coming sections.</u> </font></center>
<p><br />
For instance, Specified files by the scanning arguments will be populated into <code class="language-plaintext highlighter-rouge">ScannedFile</code> class in order to be exfiltrated and so on. The <code class="language-plaintext highlighter-rouge">scannedFile</code> class is included in the bigger <code class="language-plaintext highlighter-rouge">ScanDetails</code> class, which is also included in the bigger <code class="language-plaintext highlighter-rouge">ScanResult</code> class. It’s very important to understand the hierarchy of these nested classes, to draw a map of how the precious data assets are being organized and stolen from the infected machine.</p>

<h2 id="host-profiling">Host Profiling</h2>

<p>RedLine contains more than 20 functions to perform almost full sweeping of the infected machine. Some of them are fairly simple, they just perform windows registry querying or they use documented APIs. For instance, since Microsoft Edge is the default browser, the <code class="language-plaintext highlighter-rouge">Enumerate_Browsers()</code> function searches the registry keys <code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\Software\Clients\StartMenuInternet</code>  and its <code class="language-plaintext highlighter-rouge">WoW6432</code> twin to find the installed browsers, in order to harvest their credentials later on. The <code class="language-plaintext highlighter-rouge">Enumerate_Installed_Software()</code> function uses the registry key <code class="language-plaintext highlighter-rouge">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall</code> to list every installed software in the system.  Also, RedLine uses the <code class="language-plaintext highlighter-rouge">Take_Screenshots()</code> functions to take live screenshots of the infected system.</p>

<p><a href="Redline Stealer Malware Analysis_files/get_VS.png"><img src="Redline Stealer Malware Analysis_files/get_VS.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(7): <u>Concatinating the WMI query for the ManagementObjectSearcher class instance.</u> </font></center>
<p><br />
Moreover, the <code class="language-plaintext highlighter-rouge">Enumerate_Security_Defenders()</code> function uses the WMI to enumerate any installed security solution. It allows it to get the installed Antivirus, AntiSpyware and Firewall (third party) software using the <code class="language-plaintext highlighter-rouge">root\SecurityCenter</code> or the <code class="language-plaintext highlighter-rouge">root\SecurityCenter2</code> namespaces.</p>

<p>Not to forget, the <code class="language-plaintext highlighter-rouge">Enumerate_Running_Processess()</code> function which also uses the <code class="language-plaintext highlighter-rouge">Win32_Process</code> WMI class that represents a process on an operating system. It gets the process name + PID + command line arguemtns in order to build a live full view of the infected machine. I think the attacker uses these information to decide further malicious actions i.e. certain exploits.</p>

<p><a href="Redline Stealer Malware Analysis_files/gelocation.png"><img src="Redline Stealer Malware Analysis_files/gelocation.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(8): <u>The if-statements control wether to stop the infection or not.</u> </font></center>
<p><br />
Lastly, one more interesting function is the <code class="language-plaintext highlighter-rouge">Send()</code> function which contains the above method. It uses the following remote API <code class="language-plaintext highlighter-rouge">https://api.ip.sb/geoip</code> to gather very detailed geographical information about the victim. The remote API returns XML data specifying many detailed information:</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="err">"organization":"XXXXXXXX","longitude":XXXXXXX,"city":"XXXXXX","timezone":"XXXXXX","isp":"XXXXXXX","offset":XXXXX,"region":"XXXXX","asn":XXXXX,"asn_organization":"XXXXX","country":"XXXXX","ip":"XXXXXXX","latitude":XXXXXXX,"continent_code":"XXXX","country_code":"XXXX","region_code":"XXXXX"</span><span class="p">}</span>
</code></pre></div></div>

<h2 id="exfiltrating-files">Exfiltrating Files</h2>

<p><a href="Redline Stealer Malware Analysis_files/scanned_file_class.png"><img src="Redline Stealer Malware Analysis_files/scanned_file_class.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(9): <u>The contents of the file is being automatically read when the constructor is called with the filename string parameter.</u> </font></center>
<p><br />
It’s important to know the inner structures of the <code class="language-plaintext highlighter-rouge">ScannedFile</code> class which is used to populate the exfiltrated files. As you can see in the above screenshot, once a file is being instantiated, nearly all of its important contents is stolen.</p>

<p><a href="Redline Stealer Malware Analysis_files/exfil_files.png"><img src="Redline Stealer Malware Analysis_files/exfil_files.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(10): <u>The function shows the concatination of the searching paths.</u> </font></center>
<p><br />
Based on the <u>obtained scan arguments (settings)</u> during the previous C2 communication, they contain search patterns to specify desired files to be stolen. RedLine currently use the search patterns to locate files in the following directories only: <code class="language-plaintext highlighter-rouge">Program Files (X86)/</code>, <code class="language-plaintext highlighter-rouge">Program Files/</code>, and <code class="language-plaintext highlighter-rouge">Program Data/</code>. The directory <code class="language-plaintext highlighter-rouge">ProgramData/</code> is for user-agnostic data generated during execution such as shared cache, shared databases, shared settings, shared preferences, etc.</p>

<p><a href="Redline Stealer Malware Analysis_files/exfil_files2.png"><img src="Redline Stealer Malware Analysis_files/exfil_files2.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(11): <u>Once a ScannedFile instance is instantiated with a filename, all of the file contents is read.</u> </font></center>
<p><br />
RedLine only needs to locate the specified files based on the search patterns then create a <code class="language-plaintext highlighter-rouge">ScannedFile</code> instance of the filtered filename. Once instantiated with the filename, almost all of the file contents is stolen because of the <code class="language-plaintext highlighter-rouge">ScannedFile</code> constructor code.</p>

<h2 id="harvesting-browsers">Harvesting Browsers</h2>

<p><a href="Redline Stealer Malware Analysis_files/browser_class.png"><img src="Redline Stealer Malware Analysis_files/browser_class.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(12): <u>The collected data about the targeted browser.</u> </font></center>
<p><br />
Also, It’s very important to know the inner structures of the <code class="language-plaintext highlighter-rouge">Browser</code> class, which is used to populate the harvested browser credentials. Once a browser is targeted, RedLine steals its accounts credentials, credit card credentials, cookies, and auto-fill data. RedLine targets <u>Chromium</u> based browsers as well as <u>Gecko</u> based browsers, which makes RedLine nearly targets most used browsers.</p>

<p><a href="Redline Stealer Malware Analysis_files/harvest_browser.png"><img src="Redline Stealer Malware Analysis_files/harvest_browser.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(13): <u>Notice the passed scanning settings which were obtained by the C2 communication.</u> </font></center>
<p><br /></p>

<p><a href="Redline Stealer Malware Analysis_files/harvest_browser2.png"><img src="Redline Stealer Malware Analysis_files/harvest_browser2.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(14): <u>Populating the Browser class.</u> </font></center>
<p><br />
RedLine also uses more methods like <code class="language-plaintext highlighter-rouge">DecryptChromium()</code> in order to effectively harvest the targeted credentials. It’s also being noticed that for <u>Gecko</u> based browsers, this sample <u>only steals the cookies</u> unlike the targeted <u>Chromium</u> based browsers.</p>

<h2 id="stealing-crypto-wallets">Stealing Crypto Wallets</h2>>

<p>A crypto wallet is an application used to both cold store and retrieve digital cryptocurrency assets. RedLine of course targets these valuable assets because of the rise of people’s interest in cryptocurrency during the past few years.</p>

<p><a href="Redline Stealer Malware Analysis_files/crypto1.png"><img src="Redline Stealer Malware Analysis_files/crypto1.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(15): <u>The AllWallets class is used for generic crypto wallets.</u> </font></center>

<p><br />
RedLine comes with many classes targeting many crypto wallets like: Armory, Exodus, Ethereum, Monero, Atomic, BinanceChain, Jaxx, Electrum, Guarda, etc. RedLine uses pre-defined search patterns and scan arguments to populate the wallets into <code class="language-plaintext highlighter-rouge">ScannedFile</code> instances. Each class in the previous figure is just used to initialize defined search patterns to be passed to the regular <code class="language-plaintext highlighter-rouge">Search()</code> function which is used in files exfiltration.</p>

<p><a href="Redline Stealer Malware Analysis_files/crypto2.png"><img src="Redline Stealer Malware Analysis_files/crypto2.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(16): <u>Overriding the GetScanArgs function with new search patterns.</u> </font></center>
<p><br />
These search patterns specify the credentials files which is being used for the specific wallet type. For every wallet class, it is used to override the <code class="language-plaintext highlighter-rouge">GetScanArgs()</code> function which is used internally in the <code class="language-plaintext highlighter-rouge">Search()</code> function in order to filter for the appropriate wallet files. These filtered files will be exfiltrated.</p>

<h2 id="harvesting-instant-messenger-clients">Harvesting Instant Messenger Clients</h2>>

<p>Instant Messenger (IM) clients like Discord and Telegram have seen a recent rise in popularity, with Discord boasting over 100 million active users. For Telegram, RedLine looks used the <code class="language-plaintext highlighter-rouge">GetProcessesByName()</code> function to get the <code class="language-plaintext highlighter-rouge">ExecutablePath</code> for Telegram running process. Then, it looks for the folder <code class="language-plaintext highlighter-rouge">tdata</code>. This is where the Instant Messenger stores its session data, including images and conversations:</p>

<p><a href="Redline Stealer Malware Analysis_files/telegram1.png"><img src="Redline Stealer Malware Analysis_files/telegram1.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(17): <u>The function is passed the Telegram process name.</u> </font></center>
<p><br />
It’s also used  to override the <code class="language-plaintext highlighter-rouge">GetScanArgs()</code> function which is used internally in the <code class="language-plaintext highlighter-rouge">Search()</code> function in order to filter for the targeted files.</p>

<p>For Discord, RedLine is stealing its tokens using the <code class="language-plaintext highlighter-rouge">Discord.GetTokens()</code> function. A Discord token is a phrase of letters and numbers that acts as an authorization code to access Discord’s servers. It effectively acts as an encryption of your username and password.</p>

<h2 id="snatching-vpn-clients-credentials">Snatching VPN Clients Credentials</h2>>

<p>With the rise in popularity in VPN services, RedLine doesn’t have any plans to miss this chance. RedLine targets the VPN clients of the following services: NordVPN, OpenVPN, and ProtonVPN. For NordVPN client, RedLine uses obfuscated strings to locate the targeted XML files which contain the VPN credentials:</p>

<p><a href="Redline Stealer Malware Analysis_files/nord1.png"><img src="Redline Stealer Malware Analysis_files/nord1.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(18): <u>This method of strings obfuscation is almost used everywhere in RedLine classes.</u> </font></center>
<p><br />
Then, it uses decrypting functions to decipher the wanted credentials:</p>

<p><a href="Redline Stealer Malware Analysis_files/nord2.png"><img src="Redline Stealer Malware Analysis_files/nord2.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(19): <u>The CryptoHelper class is used for various decryption and encryption operations within RedLine.</u> </font></center>
<p><br />
Yet, for <u>OpenVPN</u> and <u>ProtonVPN</u>, RedLine uses the same old method of overriding the <code class="language-plaintext highlighter-rouge">GetScanArgs()</code> function which is used internally in the <code class="language-plaintext highlighter-rouge">Search()</code> function in order to filter for the targeted files. Then, it exfiltrates the filtered files as <code class="language-plaintext highlighter-rouge">ScannedFile</code> instances which contains the VPN credentials.</p>

<h2 id="harvesting-gaming-clients">Harvesting Gaming Clients</h2>>

<p>Steam is a video game digital distribution service by <a href="https://en.wikipedia.org/wiki/Valve_Corporation">Valve</a>. By 2019, the service had over 34,000 games with over 95 million monthly active users. Steam is regarded as one of the best gaming platforms in the industry. Steam has an in-built store with a lot of ‘Steam accounts’ having various other services and banking details related to it. RedLine attempts to go after the <u>Steam Sentry File</u> which is used to store credentials:</p>

<p><a href="Redline Stealer Malware Analysis_files/steam1.png"><img src="Redline Stealer Malware Analysis_files/steam1.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(20): <u>RedLine overrides the GetScanArgs() function with defined search patterns. Then, exfiltrate the targeted files.</u> </font></center>
<p><br />
A VDF file is a data file format used by Valve’s Source game engine. It contains various kinds of game metadata, including data for resources, installation scripts, configuration scripts, and visualization elements.</p>

<h2 id="stealing-ftp-credentials">Stealing FTP Credentials</h2>>

<p>A File Transfer Protocol client (FTP client) is a software utility that establishes a connection between a host computer and a remote server, typically an FTP server. An FTP client provides the dual-direction transfer of data and files between two computers over a TCP network or an Internet connection.</p>

<p><a href="Redline Stealer Malware Analysis_files/ftp1.png"><img src="Redline Stealer Malware Analysis_files/ftp1.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(21): <u>RedLine checks the existance of two different paths to locate the targeted credentials.</u> </font></center>
<p><br />
RedLine targets the free, open-source FileZilla application. RedLine uses the <code class="language-plaintext highlighter-rouge">ScanCredentials()</code> function to extract the required credentials and to populate them in <code class="language-plaintext highlighter-rouge">Account</code> class which will contain the URL + username + password.</p>

<h2 id="remote-execution">Remote Execution</h2>

<p>RedLine extends its functionality beyond information stealing. Here, RedLine takes the role of a malware loader. A malware <strong><em>loader</em></strong> is the software which drops the actual malicious content on the system, then executes the first stage of the attack. Hence, RedLine is capable of delivering some additional serious threats to the infected machine, like ransomwares for example. After successfully performing the information stealing operations, RedLine uses the <code class="language-plaintext highlighter-rouge">TryGetTasks()</code> function to obtain a list of <code class="language-plaintext highlighter-rouge">UpdateTask</code> class, which contains the required arguments to successfully perform remote execution actions:</p>

<p><a href="Redline Stealer Malware Analysis_files/task1.png"><img src="Redline Stealer Malware Analysis_files/task1.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(22): <u>The availabe remote actions aka update tasks.</u> </font></center>
<p><br />
Once a connection with its C&amp;C server has been established, RedLine can remotely perform the operations described in the above figure. Below are the inner details of the <code class="language-plaintext highlighter-rouge">DownloadAndExecuteUpdate</code> class which is used -as the name suggests- to download a PE file and executes it in the infected machine:</p>

<p><a href="Redline Stealer Malware Analysis_files/task2.png"><img src="Redline Stealer Malware Analysis_files/task2.png" alt="" /></a></p>
<center><font size="3"> <u>Figure</u>(23): <u>The passed argument consists of the malicious URL + the filename.</u> </font></center>
<p><br />
RedLine can be used effectively as malware loader or dropper for further wanted malicious activities. Moreover, it can be used to open desired links for various malicious or non-malicious purposes.</p>

<h1 id="conclusion">Conclusion</h1>

<p>RedLine is regarded as a true security threat to any machine. The capabilities of being able to steal almost every valuable asset, and being able to load additional serious malwares or exploits are regarded most fatal. This threat has been sold as individual packages with several pricing options, or as Malware-as-a-Service (MaaS) on a subscription-based pricing package. With the rise of Maas underground forums, RedLine threats will not fade away in the very near future. Therefore, it is a must to know how it works, how to detect it, and how to protect your organization.</p>

<p><br /></p>
<h1 id="references">References</h1>

<ul>
  <li><a href="https://blogs.blackberry.com/en/2021/07/threat-thursday-redline-infostealer">https://blogs.blackberry.com/en/2021/07/threat-thursday-redline-infostealer</a></li>
</ul>

      </section>
    </div>
  
<div class="container">
      <div>
        <h2 style="color: #fa4103;">Feedback - </h2>
        <span><textarea style="border: 1px; width: 500px; height: 200px;">Write Yr Feedback Here </textarea></span>
        <br>
        <input type="submit" value="Submit" style="height:50px; width:150px">
        </div>
        <br>
      <iframe width="800" height="500" src="https://www.youtube.com/embed/F5tSoaJ93ac" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>          
      
            </section>
          </div>
      <br>
      <footer class="container">
        <p>Created by OG34_GROUP4 {Abhay Thakur,Rishabh Jain,Om Jha,Shivaksh Sharma}. © 2021</p>
      </footer>
</body></html>